# Power BI
1. **[Introduction](#Introduction)**<br>
2. **[Power BI Desktop](#Power-BI-Desktop)**<br>
3. **[Working with MySql](#Working-with-MySql)**<br>
4. **[Working with SQL Server](#Working-with-SQL-Server)**<br>
5. **[M-Language](#M-Language)**<br>
6. **[Power BI Desktop](#Power-BI-Desktop)**<br>
7. **[Power BI Desktop](#Power-BI-Desktop)**<br>
8. **[Power BI Desktop](#Power-BI-Desktop)**<br>
9. **[Power BI Desktop](#Power-BI-Desktop)**<br>
10. **[Power BI Desktop](#Power-BI-Desktop)**<br>
11. **[Power BI Desktop](#Power-BI-Desktop)**<br>
12. **[Power BI Desktop](#Power-BI-Desktop)**<br>
13. **[Power BI Desktop](#Power-BI-Desktop)**<br>
14. **[Power BI Desktop](#Power-BI-Desktop)**<br>
15. **[Power BI Desktop](#Power-BI-Desktop)**<br>
16. **[Power BI Desktop](#Power-BI-Desktop)**<br>
17. **[Power BI Desktop](#Power-BI-Desktop)**<br>
18. **[Power BI Desktop](#Power-BI-Desktop)**<br>
19. **[Power BI Desktop](#Power-BI-Desktop)**<br>
20. **[Power BI Desktop](#Power-BI-Desktop)**<br>
21. **[Power BI Desktop](#Power-BI-Desktop)**<br>
22. **[Power BI Desktop](#Power-BI-Desktop)**<br>
23. **[Power BI Desktop](#Power-BI-Desktop)**<br>
24. **[Power BI Desktop](#Power-BI-Desktop)**<br>
25. **[Power BI Desktop](#Power-BI-Desktop)**<br>
26. **[Power BI Desktop](#Power-BI-Desktop)**<br>
27. **[Power BI Desktop](#Power-BI-Desktop)**<br>
28. **[Power BI Desktop](#Power-BI-Desktop)**<br>
29. **[Power BI Desktop](#Power-BI-Desktop)**<br>
30. **[Power BI Desktop](#Power-BI-Desktop)**<br>


# Introduction
---

##  What is BI ?
---
1. BI(Business Intelligence) is a processes that convert **Raw Data** into **Meaningful Information**
1. The **meaningful information** drives **profitable business actions**

## Do you know any BI tools?
---
1. Power BI
1. Tableau
1. Cognos
1. Bo
1. OBIEE
1. Domo
1. Qlick View/Sense
... etc

### Out of these all BI tools, which is best? why ?
---
- According to world's leading research and advisory company **Power BI** is best. 
    - [Gartner Report](https://powerbi.microsoft.com/en-us/blog/microsoft-named-a-leader-in-gartners-2020-magic-quadrant-for-analytics-and-bi-platforms/)
    - [Forrester Report](https://info.microsoft.com/ww-landing-Forrester-Wave-Enterprise-BI-platforms-website.html?LCID=EN-US)


    

## What is Power BI?
---
1. Power BI is a business analytics solution that lets you visualize your data and share **insights** across your organization, or embed them in your app or website.
1. Connect to **hundreds of data sources** and bring your data to **life** with **live dashboards** and **reports**.
1. [Visit for more information](https://powerbi.microsoft.com/en-us/what-is-power-bi/)

## Why Power BI?
---
1. Create data dashboards and visualizations in **minutes**
1. Put BI in everyone’s hands—**economically**. Please see the price of Tableau and Power BI    
    - [Power BI Price](https://powerbi.microsoft.com/en-us/pricing/)
    - [Tableau Price](https://www.tableau.com/pricing/teams-orgs#online)
1. Unify **self-service** and enterprise analytics
1. Accelerate big data prep with **Azure**
1. Find answers fast with industry-leading **AI**
1. Get unparalleled **Excel** integration
1. Turn **insights** into **action**
1. **Stream analytics** in **real time**
1. [Visit for more information](https://powerbi.microsoft.com/en-us/why-power-bi/)

## Do you know Power BI products?
---
1. **Power BI Desktop**(Windows based software)
    - Create rich,interactive reports with visual analytics at your fingertips
    - Go from `data` →  `insight` →  `action` with Power BI Desktop
    - Connect to your data, wherever it is
    - Prep and model your data with ease
    - Provide advanced analytics with the familiarity of Excel
    - Create interactive reports customized for your business
    - Power BI Desktop is nothing but three tools of excel 
        - Power Query or Power Query Editor
        - Power Pivot
        - Power View
            - [Read More](https://support.office.com/en-us/article/power-query-overview-and-learning-ed614c81-4b00-4291-bd3a-55d80767f81d)
            
2. **Power BI Service**(MSFT Cloud)
    - Dashboards are developed here
    - Conduct data-driven collaboration
    - Discover insights quickly
    - Get more done with familiar tools
    - Govern your data securely
3. Power BI Mobile
4. Power BI Embedded
5. Power BI Report Server
        

# Install Power BI Desktop
---
- Download software [here](https://www.microsoft.com/en-us/download/details.aspx?id=58494)
- Run the MSI installer and follow the setup steps    

![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation9.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation8.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation7.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation6.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation5.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation4.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation3.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation2.png?raw=true)
![](https://github.com/rritec/powerbi/blob/master/images/powerbiinstallation1.png?raw=true)
[Reference](https://docs.microsoft.com/en-us/power-bi/desktop-get-the-desktop)

# MSFT SQL Server Installation
---

## Install MSFT SQL Server Database
---

1. Download Sqlserver Developer edition [here](https://www.microsoft.com/en-au/sql-server/sql-server-downloads)

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0132.png?raw=true)
    
1. Run below **.exe** file

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0126.png?raw=true)
1. Click on **Basic**

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0127.png?raw=true)
1. Click on **Accept**

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0128.png?raw=true)
1. Click on **Install**

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0130.png?raw=true)
1. Observe connections info

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0129.png?raw=true)  
   

    

## Instal SQL Server Management Studio (SSMS) 
---

1. Download SQL Server Management Studio [here](https://www.microsoft.com/en-au/sql-server/sql-server-downloads)
1. Double Click on exe file

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0133.png?raw=true)
1.   Click on **Install**

   ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0134.png?raw=true)
1.   Click on **Restart**

   ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0136.png?raw=true)   


## Restore sample data
---

1. Follow below link download and restore sample data **AdventureWorksDW2012.bak**
https://docs.microsoft.com/en-us/sql/samples/adventureworks-install-configure?view=sql-server-ver15

## Instal MSBI (Download SQL Server Data Tools (SSDT))
---

1. Download Sqlserver Developer edition https://www.microsoft.com/en-au/sql-server/sql-server-downloads

direct link : https://docs.microsoft.com/en-us/sql/ssdt/download-sql-server-data-tools-ssdt?view=sql-server-ver15#ssdt-for-vs-2017-standalone-installer

1. Double Click on exe file

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0136.png?raw=true)
1.   Click on **install**

   ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0137.png?raw=true)
1.   Click on **install**

   ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0138.png?raw=true)   


# MySql Installation(Optional)
---
1. Download the software 
    https://dev.mysql.com/downloads/file/?id=508936
3. Ckick in msi file and install it
![image](https://user-images.githubusercontent.com/20516321/148321034-5bbd5b60-57e6-42c4-ae60-3fb446f6c1b1.png)

4. Click on Next
![image](https://user-images.githubusercontent.com/20516321/148321192-cef7b0f0-d38a-417e-b0a4-3827711da9e3.png)

5. Observe all components
![image](https://user-images.githubusercontent.com/20516321/148321246-8f013719-ee9a-428a-844b-7134cc97aaf0.png)
6. Click on Next
    ![image](https://user-images.githubusercontent.com/20516321/148321730-ebf433d9-08cb-4b66-985e-98d27a9be83b.png)

7. Provide **root** user password and notedown some where
    ![image](https://user-images.githubusercontent.com/20516321/148321849-dff93321-3f00-466c-b3ca-af97b5758a5f.png)




## Interview Questions
-----
1. What are the **key components** of power BI.
    1. Power BI Desktop(Power Query/Power Pivot/Power View)
    2. Power BI Service
    3. Power BI Mobile
    4. Power BI Maps
    5. Power BI Embeded Analytics
    
# Power BI Desktop
    - It has mainly three Components
        - Power Query Editor(Extract + Transforming + Loading into PBIX file)
        - Power Pivot (Model + DAX)
        - Power View or Report View
# Power Query Editor
- It is also known as `Power Query`
# Download all materials and data
1. Download materials [here](https://github.com/rritec/powerbi/archive/refs/heads/master.zip)
1. Create one folder on desktop with the name of **PowerBI_work**
1. Move above **powerbi-master.zip** file to **PowerBI_work** folder
1. Right click on **powerbi-master.zip** file > Click on **Extract All**
1. Observe all materials and Labs


## Import scott data from excel

![image](https://user-images.githubusercontent.com/20516321/196328872-9932cfa7-18cb-4b14-b609-e87f4d12bda2.png)


1. Go to windows search > type **Power BI** > Open **Power BI Desktop** > Click on **Get Data** > Click on **File** > Click on **Excel**

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0081.png?raw=true)
    
1. Click on **Connect** > Select **Labdata/Lab1/scottdata.xlsx** > Click on **open**
1. In **Navigator** select all three tables > Click on **Transform Data**

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0082.png?raw=true)

## Power Query has `5` main parts
1. Menu Bar(Home/Transform/Add Column/View/Tools/Help)
1. Queries Pane
1. Query Settings Pane
1. Work area
1. Formula Bar

## Replace in `emp` table `comm` column `null` with `0`
1. In **Queries** pane  > Select **emp** table > select **comm** column
1. In the **toolbar** > Click on **Replace Values** > type as shown in below image
    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0083.png?raw=true)



## Rename column name `ename` as `Employee Name`
1. In **Queries** pane > select **emp** > Right click on **ename** column 

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0087.png?raw=true)
    
1. Click on **rename** and name it as **Employee Name** > press enter

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0088.png?raw=true)
    
## Create `totalsal` column
1. In the **Menu bar** > Click on **Add Column** > Click on **Custom Column** > Name it as **totalsal**
1. Develop formula as shown in below image > Click on **ok**

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0084.png?raw=true)
1. Observe output
   
   ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0086.png?raw=true)




## Observe Data Types
1. Decimal Number
2. Fixed Decimal Number
3. Whole Number
4. Percentage
5. Date/Time
6. Date
7. Time
8. Date/Time/Timezone
9. Duration
10. Text
11. True/False
12. Binary
## Change data type of TotalSal to decimal numbar
1. Right click on **totalsal** column > click on **Change type** > Click on **Decimal Number**

## AutoFilter/Basic Filter
### Filter `sal` column to display only greater than `900`
1. Click on **sal** column down arrow mark > Click on **Number Filters** > Click on **Greater Than** > type **900** > Click on **ok**

## Save the report
1. Go to **File** menu > click on **save** > Select **powerbi_work** folder > name it as **PBI_01_02_Power Query Editor Shape data using Excel as source** > click on **ok**


## Publish the report

1. Open https://app.powerbi.com/
1. Signin with username and password given to you by your instructor
2. In the left Navigation Pane > Click on Workspaces > Click on Create a Workspace > provide workspace name as rritec - workspace > click on Save
3. In **Power BI Desktop** > click on **signin** and pass username and password
4. Click on **publish** > Select above workspace **rritec - workspace** > click on ok
5. Go to **power BI service** > observe report
    

## Reference 

https://docs.microsoft.com/en-us/power-bi/fundamentals/desktop-getting-started

https://docs.microsoft.com/en-us/power-bi/connect-data/desktop-shape-and-combine-data

https://docs.microsoft.com/en-us/power-bi/transform-model/desktop-common-query-tasks

https://docs.microsoft.com/en-us/power-bi/desktop-add-custom-column

https://docs.microsoft.com/en-us/powerquery-m/power-query-m-function-reference


```python

```
## Questions
1. **Power BI** Key Components?
    - Power BI Desktop
    - Power BI Service
    - Power BI Mobile
1. **Power BI Desktop** Key components
    - Power Query Editor
    - Power Pivot
    - Power View
1. Power Query Editor useing which language?
    - M - Language
1. Can we import 2 sheets from excel workbook which has 5 sheets?
    - Yes
1. Each Sheet is called as what in power Query Editor?
    - Query
1. Can we reorder Transformation steps in **Qurry Settings**?
    - Yes
1. What is the extension of Power BI File?
    - .PBIX
1. The calculation in Power Query Editor is called as ?
    - Co**M**uting Column
1. Can you name some of the Power BI supporting Data Types?
    - Whole Number
    - Deciambal
    - Text
    - Date
    - True/False(Bool)
    - DateTime
    - .... etc
    
1. In how many ways we can see the list of query applied steps?
   - Query setting pane
   - Advance Editor
1. In Excel how many kinds of data containers available?
    - Sheet
    - Table
1. How Many Data Sources/Data bases worked ?
    - Flat Files(Excel,Csv,Tab delimited,Json,XML...etc)
    - Relational Databases (MS Sql Server,Oracle,Teradata,MySql,BigData Hive,...etc)
    - Cloud Databases(Snow Flake,Azure SQl Database,Azure Synapse,Azure Blobs...etc)


# Working with MySql

![image](https://user-images.githubusercontent.com/20516321/196849404-a9371f5d-6a66-4d5c-9285-75e3131c8332.png)


1. MySql is a oracle product
1. Install **MySql** software by following [this link](https://github.com/rritec/powerbi/blob/master/Notebooks/PBI_01_01_Introduction_Installation.md#mysql-installationoptional)
1. Open **MySql Workbench** > if required create **new connection** or use **existing connection** > Click on **New SQL Tab for execution of queries**
1. In **Navigator** Window in empty space > Right Click > click on **Create Schema** > Provide schema name as **rritecdb** > click on **apply** > click on **apply** > Click on **Finish**

**or**

run below script 

``` sql
CREATE SCHEMA rritecDB;
```
``` sql
USE rritecdb;
```

## Load Data
``` sql
drop table if exists emp;

drop table if exists dept;

drop table if exists salgrade;

drop table if exists emp10;

drop table if exists emp20;

drop table if exists emp30;
```

``` sql
CREATE TABLE `emp` (
  `empno` decimal(4,0) NOT NULL,
  `ename` varchar(10) DEFAULT NULL,
  `job` varchar(9) DEFAULT NULL,
  `mgr` decimal(4,0) DEFAULT NULL,
  `hiredate` date DEFAULT NULL,
  `sal` decimal(7,2) DEFAULT NULL,
  `comm` decimal(7,2) DEFAULT NULL,
  `deptno` decimal(2,0) DEFAULT NULL,
  `test` varchar(100) DEFAULT NULL
) ;


INSERT INTO emp (empno,ename,job,mgr,hiredate,sal,comm,deptno,test) VALUES 
(7369,'SMITH','CLERK',7902,'1980-12-17',800.00,NULL,20,'1')
,(7499,'ALLEN','SALESMAN',7698,'1981-02-20',1600.00,300.00,30,'1')
,(7521,'WARD','SALESMAN',7698,'1981-02-22',1250.00,500.00,30,'1')
,(7566,'JONES','MANAGER',7839,'1981-04-02',2975.00,NULL,20,'1')
,(7654,'MARTIN','SALESMAN',7698,'1981-09-28',1250.00,1400.00,30,'1')
,(7698,'BLAKE','MANAGER',7839,'1981-05-01',2850.00,NULL,30,'1')
,(7782,'CLARK','MANAGER',7839,'1981-06-09',2450.00,NULL,10,'1')
,(7788,'SCOTT','ANALYST',7566,'1982-12-09',3000.00,NULL,20,'1')
,(7839,'KING','PRESIDENT',NULL,'1981-11-17',5000.00,NULL,10,'1')
,(7844,'TURNER','SALESMAN',7698,'1981-09-08',1500.00,0.00,30,'1')
,(7876,'ADAMS','CLERK',7788,'1983-01-12',1100.00,NULL,20,'1')
,(7900,'JAMES','CLERK',7698,'1981-12-03',950.00,NULL,30,'1')
,(7902,'FORD','ANALYST',7566,'1981-12-03',3000.00,NULL,20,'1')
,(7934,'MILLER','CLERK',7782,'1982-01-23',1300.00,NULL,10,'1')
,(1234,'RamReddy','DS',7839,'1981-12-03',2400.00,100.00,50,'1')
;

CREATE TABLE `dept` (
  `deptno` decimal(2,0) DEFAULT NULL,
  `dname` varchar(14) DEFAULT NULL,
  `loc` varchar(13) DEFAULT NULL,
  `test` varchar(100) DEFAULT NULL
) ;

INSERT INTO dept (deptno,dname,loc,test) VALUES 
(10,'ACCOUNTING','NEW YORK','1')
,(20,'RESEARCH','DALLAS','1')
,(30,'SALES','CHICAGO','1')
,(40,'OPERATIONS','BOSTON','1')
;

CREATE TABLE salgrade(
  grade decimal(1),
  losal decimal(4),
  hisal decimal(4)
);

INSERT INTO salgrade VALUES 
(1, 700, 1200)
,(2, 1201, 1400)
,(3, 1401, 2000)
,(4, 2001, 3000)
,(5, 3001, 9999);

CREATE TABLE `emp10` (
  `empno` decimal(4,0) NOT NULL,
  `ename` varchar(10) DEFAULT NULL,
  `job` varchar(9) DEFAULT NULL,
  `mgr` decimal(4,0) DEFAULT NULL,
  `hiredate` date DEFAULT NULL,
  `sal` decimal(7,2) DEFAULT NULL,
  `comm` decimal(7,2) DEFAULT NULL,
  `deptno` decimal(2,0) DEFAULT NULL,
  `test` varchar(100) DEFAULT NULL
) ;


INSERT INTO emp10 (empno,ename,job,mgr,hiredate,sal,comm,deptno,test) VALUES 
(7782,'CLARK','MANAGER',7839,'1981-06-09',2450.00,NULL,10,'1')
,(7839,'KING','PRESIDENT',NULL,'1981-11-17',5000.00,NULL,10,'1')
,(7934,'MILLER','CLERK',7782,'1982-01-23',1300.00,NULL,10,'1')
;

CREATE TABLE `emp20` (
  `empno` decimal(4,0) NOT NULL,
  `ename` varchar(10) DEFAULT NULL,
  `job` varchar(9) DEFAULT NULL,
  `mgr` decimal(4,0) DEFAULT NULL,
  `hiredate` date DEFAULT NULL,
  `sal` decimal(7,2) DEFAULT NULL,
  `comm` decimal(7,2) DEFAULT NULL,
  `deptno` decimal(2,0) DEFAULT NULL,
  `test` varchar(100) DEFAULT NULL
) ;


INSERT INTO emp20 (empno,ename,job,mgr,hiredate,sal,comm,deptno,test) VALUES 
(7369,'SMITH','CLERK',7902,'1980-12-17',800.00,NULL,20,'1')
,(7566,'JONES','MANAGER',7839,'1981-04-02',2975.00,NULL,20,'1')
,(7788,'SCOTT','ANALYST',7566,'1982-12-09',3000.00,NULL,20,'1')
,(7876,'ADAMS','CLERK',7788,'1983-01-12',1100.00,NULL,20,'1')
,(7902,'FORD','ANALYST',7566,'1981-12-03',3000.00,NULL,20,'1')
;

CREATE TABLE `emp30` (
  `empno` decimal(4,0) NOT NULL,
  `ename` varchar(10) DEFAULT NULL,
  `job` varchar(9) DEFAULT NULL,
  `mgr` decimal(4,0) DEFAULT NULL,
  `hiredate` date DEFAULT NULL,
  `sal` decimal(7,2) DEFAULT NULL,
  `comm` decimal(7,2) DEFAULT NULL,
  `deptno` decimal(2,0) DEFAULT NULL,
  `test` varchar(100) DEFAULT NULL
) ;


INSERT INTO emp30 (empno,ename,job,mgr,hiredate,sal,comm,deptno,test) VALUES 
(7499,'ALLEN','SALESMAN',7698,'1981-02-20',1600.00,300.00,30,'1')
,(7521,'WARD','SALESMAN',7698,'1981-02-22',1250.00,500.00,30,'1')
,(7654,'MARTIN','SALESMAN',7698,'1981-09-28',1250.00,1400.00,30,'1')
,(7698,'BLAKE','MANAGER',7839,'1981-05-01',2850.00,NULL,30,'1')
,(7844,'TURNER','SALESMAN',7698,'1981-09-08',1500.00,0.00,30,'1')
,(7900,'JAMES','CLERK',7698,'1981-12-03',950.00,NULL,30,'1')
;
```
## Import below tables into Power BI

1. emp
1. dept
1. salgrade
1. emp10
1. emp20
1. emp30


1. Open **Power BI Desktop** > Click on **Get Data** > Click on **Databases** > select **MySql Database** > click on **connect**

![](https://github.com/rritec/powerbi/blob/master/images/PBI_0089.png?raw=true)
 
1. provider server as **localhost** > Database as **rritec** > Click on **ok**

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0090.png?raw=true)
    
1. Select all the tables as shown below > clcik on **LoadData** 

    ![](https://github.com/rritec/powerbi/blob/master/images/PBI_0091.png?raw=true)


## Do all exercise of Previous chapter [PBI_01_02_Power Query Editor Shape data using Excel as source](https://github.com/rritec/powerbi/blob/master/Notebooks/PBI_01_02_Power%20Query%20Editor%20Shape%20data%20using%20Excel%20as%20source.md)

## Questions
1. What is the official tool, to query MySql database?
    - MySQL Workbench
2. 
```python

```
# Working with SQL Server
---
**Note:** Mostly as **BI** developer, we wont get chance to create databases,tables and loading data. In our training program, we are creating simple database with couple of small tables.

![image](https://user-images.githubusercontent.com/20516321/196590254-29b812c3-efdb-4ea8-9af8-d3d84a861fe3.png)


## Load Data

1. Open SSMS > Provide below info > Click on **Connect**

![image](https://user-images.githubusercontent.com/20516321/116333897-f25bee00-a7f1-11eb-8cd0-161a5ed8e4dc.png)
``` sql
CREATE DATABASE rritecDB;

GO

use rritecDB;

GO

CREATE TABLE [dbo].[DEPT]
(DEPTNO INT PRIMARY KEY ,
DNAME VARCHAR(20),
LOC VARCHAR(20) );

GO

INSERT INTO [dbo].[DEPT] VALUES (10, 'ACCOUNTING', 'NEW YORK');

INSERT INTO [dbo].[DEPT] VALUES (20, 'RESEARCH', 'DALLAS');

INSERT INTO [dbo].[DEPT] VALUES (30, 'SALES', 'CHICAGO');

INSERT INTO [dbo].[DEPT] VALUES (40, 'OPERATIONS', 'BOSTON');


CREATE TABLE [dbo].[EMP]
(EMPNO INT PRIMARY KEY,
ENAME VARCHAR(20),
JOB VARCHAR(20),
MGR INT,
HIREDATE DATE,
SAL MONEY,
COMM MONEY,
DEPTNO INT );

GO

INSERT INTO [dbo].[EMP] VALUES (7369, 'SMITH', 'CLERK', 7902, '17-DEC-1980', 800, NULL, 20);

INSERT INTO [dbo].[EMP] VALUES (7499, 'ALLEN', 'SALESMAN', 7698, '20-FEB-1981', 1600, 300, 30);

INSERT INTO [dbo].[EMP] VALUES (7521, 'WARD', 'SALESMAN', 7698, '22-FEB-1981', 1250, 500, 30);

INSERT INTO [dbo].[EMP] VALUES (7566, 'JONES', 'MANAGER', 7839, '2-APR-1981', 2975, NULL, 20);

INSERT INTO [dbo].[EMP] VALUES (7654, 'MARTIN', 'SALESMAN', 7698, '28-SEP-1981', 1250, 1400, 30);

INSERT INTO [dbo].[EMP] VALUES (7698, 'BLAKE', 'MANAGER', 7839, '1-MAY-1981', 2850, NULL, 30);

INSERT INTO [dbo].[EMP] VALUES (7782, 'CLARK', 'MANAGER', 7839, '9-JUN-1981', 2450, NULL, 10);

INSERT INTO [dbo].[EMP] VALUES (7788, 'SCOTT', 'ANALYST', 7566, '09-DEC-1982', 3000, NULL, 20);

INSERT INTO [dbo].[EMP] VALUES (7839, 'KING', 'PRESIDENT', NULL, '17-NOV-1981', 5000, NULL, 10);

INSERT INTO [dbo].[EMP] VALUES (7844, 'TURNER', 'SALESMAN', 7698, '8-SEP-1981', 1500, 0, 30);

INSERT INTO [dbo].[EMP] VALUES (7876, 'ADAMS', 'CLERK', 7788, '12-JAN-1983', 1100, NULL, 20);

INSERT INTO [dbo].[EMP] VALUES (7900, 'JAMES', 'CLERK', 7698, '3-DEC-1981', 950, NULL, 30);

INSERT INTO [dbo].[EMP] VALUES (7902, 'FORD', 'ANALYST', 7566, '3-DEC-1981', 3000, NULL, 20);

INSERT INTO [dbo].[EMP] VALUES (7934, 'MILLER', 'CLERK', 7782, '23-JAN-1982', 1300, NULL, 10);

INSERT INTO [dbo].[EMP] VALUES (1234, 'Ram', 'CLERK', 7782, '23-JAN-1982', 1400, NULL, 50);

GO

CREATE TABLE [dbo].[SALGRADE]
(GRADE INT NOT NULL,
LOSAL MONEY,
HISAL MONEY );

GO

INSERT INTO [dbo].[SALGRADE] VALUES (1, 700, 1200);

INSERT INTO [dbo].[SALGRADE] VALUES (2, 1201, 1400);

INSERT INTO [dbo].[SALGRADE] VALUES (3, 1401, 2000);

INSERT INTO [dbo].[SALGRADE] VALUES (4, 2001, 3000);

INSERT INTO [dbo].[SALGRADE] VALUES (5, 3001, 9999);
```

## Import tables(emp,dept and salgrade) into Power BI
---

1. Open **Power BI Desktop** > Click on **Get Data** > Click on **Databases** > select **SqlServer Database** > click on **connect**


 
1. provider server as **localhost** > Database as **rritecDB** > Click on **ok**

    
    
1. Select emp and dept tables > clcik on **LoadData** 

 
## Exercise:
- Do all exercise of [PBI_01_02_Power Query Editor Shape data using Excel as source](https://github.com/rritec/powerbi/blob/8cd3e9b6ff889c7056baf4c71b951dd152a41c16/Notebooks/PBI_01_02_Power%20Query%20Editor%20Shape%20data%20using%20Excel%20as%20input.md)

## Questioons
---
1. What is SSMS ?
 - SQL Server Management Studio (SSMS) is an IDE that provides a graphical interface for connecting and working with MS SQL server
2. How many rows inserted in emp table ?
 - 14 (select count(*) from [dbo].[emp])
3. Write SQL to get deptname wise salary expenditure?
 - select dnmae,sum(sal) from [dbo].[emp],[dbo].[dept] where emp.deptno=dept.deptno group by dname
4. Who is top sal employee?
 - King(5000)


# M-Language

1. Power Query is a Formula Language (Informally known as "M")
2. **M** stands for **Mash-Up**
3. **M** is a case-sensitive language
4. Power Query is a data transformation and data preparation engine. Power Query comes with a graphical interface for getting data from sources and a Power Query Editor for applying transformations. Because the engine is available in many products and services, the destination where the data will be stored depends on where Power Query was used. Using Power Query, you can perform the extract, transform, and load (ETL) processing of data.

![image](https://user-images.githubusercontent.com/20516321/118579120-12584f00-b7ab-11eb-8f40-dee8dd8bfd24.png)

## Reference doc 

https://docs.microsoft.com/en-us/powerquery-m/quick-tour-of-the-power-query-m-formula-language

### Exercise 1: Write Simple M-languge Query

1. Open **Power BI Desktop** > Click on **Get Data** > Click on **Blank Query** > In **Power Query Editor** > Click on **Advanced Editor** > Then copy paste below code

``` F#
let
    x = 1 +1,
    y= 2+2,
    z = x+y+3
in
    z
```
1. Click on done
2. Click on apply and close
3. develop report and observe output
### Exercise 2: Write Simple M-languge Query with spaces in variable name.

1. Replace above code with below code and observe result

``` F#
let
        #"First Name" = "Ram",
        #"Last Name" = "Reddy",
        #"Full Name" = Text.Combine({#"First Name", #"Last Name"})
in
        #"Full Name"
```
            
            
 ### Exercise 3: Call functions in M-language

1. Replace above code with below code and observe result

``` F#
//this is a single line comment
/* This
is 
a
multiline
comment*/

let
   date = #date(2021,04,25),
   year = Date.Year(date)
in
    year
```
### Exercise 4: Real world example

1. Open any one PBIX file and observe M-language code
2. In screenshot below, you can see all basics mentioned so far:
        - **let** and **in** block
        - Variable names matching steps applied in the query
        - Some variable names with hashtag and double quote: #”var name”
        - End of the line characters: **comma**
        - Calling many functions
        ![image](https://user-images.githubusercontent.com/20516321/116349500-c77f9300-a80d-11eb-9559-0d88ac8890b5.png)

### Questions:
---
1. What is the result of below program

```F#
let 
        Sales2007 =  
        [  
            Year = 2007,  
            FirstHalf = 1000,  
            SecondHalf = 1100, 
            Total = FirstHalf + SecondHalf // 2100 
        ], 
        Sales2008 =  
        [  
            Year = 2008,  
            FirstHalf = 1200,  
            SecondHalf = 1300, 
            Total = FirstHalf + SecondHalf // 2500 
        ] 
in 
        Sales2007[Total] + Sales2008[Total]
```

2. What is the result of below program

```F#
let
        SimpleInterest = (p,t,r) => p*t*r/100,
        // Here 
        // p is principal
        // t is time in months
        // r is rate of interest
        rs = SimpleInterest(100,12,2)
in 
        rs
```

3. What is the result of below program

```F#
let
    a =
    [
        x = 1,       
        y = 2,       
        z = x + y    
    ], 
    b = 3             
in 
    a[z] + b         
```

4. What is the result of below program

```F#
let
    a = List.Contains({1, 2, 3, 4, 5}, 3),
    b = List.Contains({1, 2, 3, 4, 5}, 6)
in 
    {a,b}        
```

5. What is the result of below program

```F#
let
        rs = List.Select({1, -3, 4, 9, -2}, each _ > 0)
in 
        rs  
```

6. What is the result of below program

```F#
let
        rs = List.Sum({1, 2, 3})
in 
        rs
```
   


7. What is the result of below program

```F#
let
   student=Table.FromRecords(
    {
        [sno =101,sname="ram",scourse="powerbi",sfee=100],
        [sno =102,sname="nancy",scourse="powerapps",sfee=200],
        [sno =103,sname="john",scourse="powerautomate",sfee=300]
    }
       )
in
    student       

```
8. What is the result of below program

```F#
let
rs = Table.AlternateRows(
    Table.FromRecords({
        [CustomerID = 1, Name = "Bob", Phone = "123-4567"],
        [CustomerID = 2, Name = "Jim", Phone = "987-6543"],
        [CustomerID = 3, Name = "Paul", Phone = "543-7890"]
    }),
    1,1,1
)
in 
        rs       
```
9. What is the result of below program

```F#
let
        rs = Table.FuzzyGroup(
            Table.FromRecords(
                {
                    [EmployeeID = 1, Location = "Seattle"],
                    [EmployeeID = 2, Location = "seattl"],
                    [EmployeeID = 3, Location = "Vancouver"],
                    [EmployeeID = 4, Location = "Seatle"],
                    [EmployeeID = 5, Location = "vancover"],
                    [EmployeeID = 6, Location = "Seattle"],
                    [EmployeeID = 7, Location = "Vancouver"]
                },
                type table [EmployeeID = nullable number, Location = nullable text]
            ),
            "Location",
            {"Count", each Table.RowCount(_)},
            [IgnoreCase = true, IgnoreSpace = true]
        )
in 
        rs       
```

10. What is the result of below program

```F#
let
    startdate=DateTime.From(#date(2022, 1, 1)),
    enddate=DateTime.LocalNow(),
    numberofdays=Duration.Days(enddate-startdate),
    Dates = List.DateTimes(startdate, numberofdays+1, #duration(1,0,0,0)),
    #"Converted to Table" = Table.FromList(Dates, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #"Renamed Columns" = Table.RenameColumns(#"Converted to Table",{{"Column1", "Date"}}),
    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"Date", type datetime}}),
    #"Added Custom" = Table.AddColumn(#"Changed Type", "year", each Date.Year([Date])),
    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom",{{"year", Int64.Type}}),
    #"Added Custom1" = Table.AddColumn(#"Changed Type1", "monthnumber", each Date.Month([Date])),
    #"Added Custom2" = Table.AddColumn(#"Added Custom1", "Monthname", each Date.MonthName([Date])),
    #"Changed Type2" = Table.TransformColumnTypes(#"Added Custom2",{{"monthnumber", Int64.Type}, {"Monthname", type text}}),
    #"Added Custom3" = Table.AddColumn(#"Changed Type2", "daynumber", each Date.Day([Date])),
    #"Added Custom4" = Table.AddColumn(#"Added Custom3", "weeknumber", each Date.WeekOfYear([Date])),
    #"Changed Type4" = Table.TransformColumnTypes(#"Added Custom4",{{"weeknumber", Int64.Type}})
    
in
     #"Changed Type4"      
```
 
